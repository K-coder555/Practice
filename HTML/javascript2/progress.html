<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bootstrap Progress Bar 예제</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>

<div class="container mt-5">
    <h2>Progress Bar 예제</h2>
    <p>버튼을 클릭하면 1초에 10%씩 진행률이 증가하고, 3~5초 사이의 랜덤한 시간에 100%가 되며 멈춥니다.</p>

    <div class="progress" style="height: 25px;">
        <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar"style="width: 0%;">
            0%
        </div>
    </div>

    <button id="startButton" class="btn btn-primary mt-3">Start</button>

    <p id="statusMessage" class="mt-2"></p>
</div>

<script>
    const startButton = document.getElementById('startButton');
    const progressBar = document.getElementById('progressBar');
    const statusMessage = document.getElementById('statusMessage');

    let progressInterval;
    let completionTimeout;

    startButton.addEventListener('click', () => {
        // 이전 타이머/인터벌이 있다면 초기화
        clearInterval(progressInterval);
        clearTimeout(completionTimeout);

        // 버튼 비활성화 및 프로그레스 바 초기화
        startButton.disabled = true;
        statusMessage.textContent = '진행 중...';
        let currentProgress = 0;
        progressBar.style.width = '0%';
        progressBar.textContent = '0%';


        // 1초마다 10%씩 증가
        progressInterval = setInterval(() => {
            if (currentProgress < 100) {
                currentProgress += 10;
                progressBar.style.width = currentProgress + '%';
                progressBar.textContent = currentProgress + '%';
            }
        }, 1000);

        // 3초에서 5초 사이의 랜덤한 종료 시간 생성 (밀리초 단위)
        const randomStopTime = Math.random() * (2000) + 3000;

        // 랜덤한 시간 후에 종료 처리
        completionTimeout = setTimeout(() => {
            clearInterval(progressInterval); // 10%씩 증가하는 인터벌 중지

            // 프로그레스 바를 100%로 설정
            progressBar.style.width = '100%';
            progressBar.textContent = '100%';

            // 상태 메시지 변경 및 버튼 다시 활성화
            statusMessage.textContent = `완료! (종료 시간: ${(randomStopTime / 1000).toFixed(2)}초)`;
            startButton.disabled = false;

        }, randomStopTime);
    });
</script>

<!-- Bootstrap JS Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>
